{"ast":null,"code":"/*\n* Copyright (c) 2013, Yahoo! Inc. All rights reserved.\n* Copyrights licensed under the New BSD License.\n* See the accompanying LICENSE file for terms.\n*/\nvar CacheObject = function (conf) {\n  conf = conf || {};\n  conf.ttl = parseInt(conf.ttl, 10) || 300; //0 is not permissible\n\n  conf.cachesize = parseInt(conf.cachesize, 10) || 1000; //0 is not permissible\n\n  this.ttl = conf.ttl * 1000;\n  this.max = conf.cachesize;\n  this.count = 0;\n  this.data = {};\n\n  var next = require('asap');\n\n  this.set = function (key, value, callback) {\n    var self = this;\n    next(function () {\n      if (self.data[key]) {\n        if (self.data[key].newer) {\n          if (self.data[key].older) {\n            self.data[key].newer.older = self.data[key].older;\n            self.data[key].older.newer = self.data[key].newer;\n          } else {\n            self.tail = self.data[key].newer;\n            delete self.tail.older;\n          }\n\n          self.data[key].older = self.head;\n          self.head.newer = self.data[key];\n          delete self.data[key].newer;\n          self.head = self.data[key];\n        }\n\n        self.head.val = value;\n        self.head.hit = 0;\n        self.head.ts = Date.now();\n      } else {\n        // key is not exist\n        self.data[key] = {\n          \"key\": key,\n          \"val\": value,\n          \"hit\": 0,\n          \"ts\": Date.now()\n        };\n\n        if (!self.head) {\n          // cache is empty\n          self.head = self.data[key];\n          self.tail = self.data[key];\n        } else {\n          // insert the new entry to the front\n          self.head.newer = self.data[key];\n          self.data[key].older = self.head;\n          self.head = self.data[key];\n        }\n\n        if (self.count >= self.max) {\n          // remove the tail\n          var temp = self.tail;\n          self.tail = self.tail.newer;\n          delete self.tail.next;\n          delete self.data[temp.key];\n        } else {\n          self.count = self.count + 1;\n        }\n      }\n      /* jshint -W030 */\n\n\n      callback && callback(null, value);\n    });\n  };\n\n  this.get = function (key, callback) {\n    var self = this;\n\n    if (!callback) {\n      throw 'cache.get callback is required.';\n    }\n\n    next(function () {\n      if (!self.data[key]) {\n        return callback(null, undefined);\n      }\n\n      var value;\n\n      if (conf.ttl !== 0 && Date.now() - self.data[key].ts >= self.ttl) {\n        if (self.data[key].newer) {\n          if (self.data[key].older) {\n            // in the middle of the list\n            self.data[key].newer.older = self.data[key].older;\n            self.data[key].older.newer = self.data[key].newer;\n          } else {\n            // tail\n            self.tail = self.data[key].newer;\n            delete self.tail.older;\n          }\n        } else {\n          // the first item\n          if (self.data[key].older) {\n            self.head = self.data[key].older;\n            delete self.head.newer;\n          } else {\n            // 1 items\n            delete self.head;\n            delete self.tail;\n          }\n        }\n\n        delete self.data[key];\n        self.count = self.count - 1;\n      } else {\n        self.data[key].hit = self.data[key].hit + 1;\n        value = self.data[key].val;\n      }\n\n      callback(null, value);\n    });\n  };\n};\n\nmodule.exports = CacheObject;","map":{"version":3,"sources":["C:/Users/michael.james/Desktop/EmailValidation/email-validation/node_modules/dnscache/lib/cache.js"],"names":["CacheObject","conf","ttl","parseInt","cachesize","max","count","data","next","require","set","key","value","callback","self","newer","older","tail","head","val","hit","ts","Date","now","temp","get","undefined","module","exports"],"mappings":"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","sourcesContent":["/*\n* Copyright (c) 2013, Yahoo! Inc. All rights reserved.\n* Copyrights licensed under the New BSD License.\n* See the accompanying LICENSE file for terms.\n*/\n\nvar CacheObject = function (conf) {\n    conf = conf || {};\n    conf.ttl = parseInt(conf.ttl, 10) || 300; //0 is not permissible\n    conf.cachesize = parseInt(conf.cachesize, 10) || 1000; //0 is not permissible\n    \n    this.ttl = conf.ttl * 1000;\n    this.max = conf.cachesize;\n\n    this.count = 0;\n    this.data = {};\n    var next = require('asap');\n\n    this.set = function (key, value, callback) {\n        var self = this;\n        next(function () {\n            if (self.data[key]) {\n                if (self.data[key].newer) {\n                    if (self.data[key].older) {\n                        self.data[key].newer.older = self.data[key].older;\n                        self.data[key].older.newer = self.data[key].newer;\n                    } else {\n                        self.tail = self.data[key].newer;\n                        delete self.tail.older;\n                    }\n\n                    self.data[key].older = self.head;\n                    self.head.newer = self.data[key];\n                    delete self.data[key].newer;\n                    self.head = self.data[key];\n                }\n\n                self.head.val = value;\n                self.head.hit = 0;\n                self.head.ts = Date.now();\n            } else {\n                // key is not exist\n                self.data[key] = {\n                    \"key\" : key,\n                    \"val\" : value,\n                    \"hit\" : 0,\n                    \"ts\" : Date.now()\n                };\n\n                if (!self.head) {\n                    // cache is empty\n                    self.head = self.data[key];\n                    self.tail = self.data[key];\n                } else {\n                    // insert the new entry to the front\n                    self.head.newer = self.data[key];\n                    self.data[key].older = self.head;\n                    self.head = self.data[key];\n                }\n\n                if (self.count >= self.max) {\n                    // remove the tail\n                    var temp = self.tail;\n                    self.tail = self.tail.newer;\n                    delete self.tail.next;\n                    delete self.data[temp.key];\n                } else {\n                    self.count = self.count + 1;\n                }\n            }\n            /* jshint -W030 */\n            callback && callback(null, value);\n        });\n    };\n\n    this.get = function (key, callback) {\n        var self = this;\n        if (!callback) {\n            throw('cache.get callback is required.');\n        }\n\n        next(function () {\n            if (!self.data[key]) {\n                return callback(null, undefined);\n            }\n            var value;\n            if (conf.ttl !== 0 && (Date.now() - self.data[key].ts) >= self.ttl) {\n                if (self.data[key].newer) {\n                    if (self.data[key].older) {\n                        // in the middle of the list\n                        self.data[key].newer.older = self.data[key].older;\n                        self.data[key].older.newer = self.data[key].newer;\n                    } else {\n                        // tail\n                        self.tail = self.data[key].newer;\n                        delete self.tail.older;\n                    }\n                } else {\n                    // the first item\n                    if (self.data[key].older) {\n                        self.head = self.data[key].older;\n                        delete self.head.newer;\n                    } else {\n                        // 1 items\n                        delete self.head;\n                        delete self.tail;\n                    }\n                }\n\n                delete self.data[key];\n                self.count = self.count - 1;\n            } else {\n                self.data[key].hit = self.data[key].hit + 1;\n                value = self.data[key].val;\n            }\n            callback(null, value);\n        });\n    };\n};\n\nmodule.exports = CacheObject;\n"]},"metadata":{},"sourceType":"script"}